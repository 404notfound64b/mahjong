"use strict";(self.webpackChunkmah=self.webpackChunkmah||[]).push([[124],{4124:(Lt,E,p)=>{p.r(E),p.d(E,{EditorModule:()=>Tt});var G=p(1368),J=p(6528),t=p(120),C=p(5736),m=p(8836);class h{constructor(){this.levels=[],this.init(2,2,1)}init(r,n,e){const o=new Array(e);for(let a=0;a<e;a++){o[a]=new Array(r);for(let s=0;s<r;s++){o[a][s]=new Array(n);for(let l=0;l<n;l++)o[a][s][l]=0}}this.levels=o}clear(){const r=this.levels;for(let n=0;n<r.length;n++)for(let e=0;e<r[n].length;e++)for(let o=0;o<r[n][e].length;o++)r[n][e][o]=0}inBounds(r,n,e){return r>=0&&n>=0&&e>=0&&r<this.levels.length&&n<this.levels[0].length&&e<this.levels[0][0].length}isTile(r,n,e){return this.levels[r][n][e]>0}isTilePosInvalid(r,n,e){return!this.levels[r][n+1]||this.levels[r][n].length-1===e||this.levels[r][n][e+1]>0||(this.levels[r][n-1]?this.levels[r][n-1][e+1]:0)>0||(this.levels[r][n-1]?this.levels[r][n-1][e-1]:0)>0||(this.levels[r][n+1]?this.levels[r][n+1][e]:0)>0||(this.levels[r][n+1]?this.levels[r][n+1][e-1]:0)>0||(this.levels[r][n+1]?this.levels[r][n+1][e-1]:0)>0||(this.levels[r][n+1]?this.levels[r][n+1][e+1]:0)>0}isTilePosBlocked(r,n,e){return this.levels[r][n][e-1]>0||!!this.levels[r][n-1]&&(this.levels[r][n-1][e]>0||this.levels[r][n-1][e-1]>0)}get(r,n,e){return this.levels[r][n][e]||0}setValue(r,n,e,o){this.levels[r][n][e]=o}applyMapping(r,n,e,o){const a=(0,m.wX)(r,n,e,o);this.init(a.x+1,a.y+1,a.z),r.forEach(s=>{this.setValue(s[0],s[1],s[2],1)})}}var _=p(5864),R=p(8024),g=p(1528);function f(){return(f=(0,g.c)(function*(i,r,n,e,o){const a=r*n;if(o.length!==a*i)return Promise.reject(Error("Invalid Matrix Pattern length"));const l={name:e,cat:"Kyodai",mapping:[]};for(let c=0;c<i;c++){const d=o.slice(c*a,(c+1)*a);for(let u=0;u<r;u++)d.slice(u*n,(u+1)*n).split("").forEach((Yt,$t)=>{"1"===Yt&&l.mapping.push([c,$t,u])})}return l})).apply(this,arguments)}function v(){return(v=(0,g.c)(function*(i,r){return function I(i,r,n,e,o){return f.apply(this,arguments)}(5,20,34,i,r)})).apply(this,arguments)}function T(i,r){return y.apply(this,arguments)}function y(){return(y=(0,g.c)(function*(i,r){const n=[];return i.forEach((e,o)=>{const a=Math.floor(o/r),s=o%r;e.split("").forEach((l,c)=>{"1"===l&&n.push([a,c,s])})}),n})).apply(this,arguments)}function M(){return(M=(0,g.c)(function*(i,r){let n=i.replace(/\r\n/g,"\n").split("\n");const e=r.split(".");e.pop();const o=n.shift()||"",a={name:e.join(".").replace(/_/g," "),cat:"uncategorized",mapping:[]};if(["kmahjongg-layout-v1.0"].includes(o))return a.by="KDE Games team",a.mapping=yield T(n.filter(s=>!s.startsWith("#")),16),a;if(["kmahjongg-layout-v1.1"].includes(o)){const s=Number((n.find(d=>d.startsWith("h"))||"h16").split("").slice().join("")),l=(n.find(d=>d.startsWith("# name:"))||"").slice(7).trim();a.name=l||a.name;const c=(n.find(d=>d.startsWith("# by:"))||"").slice(5).trim();return a.by=c||a.by,n=n.filter(d=>!(d.startsWith("h")||d.startsWith("w")||d.startsWith("d")||d.startsWith("#"))),a.mapping=yield T(n,isNaN(s)?16:s),a}return Promise.reject(Error(`Unknown .layout format ${JSON.stringify((o||"").slice(0,50))}`))})).apply(this,arguments)}function x(){return x=(0,g.c)(function*(i,r){const n=i.replace(/\r\n/g,"\n").split("\n"),e=n[0]||"";if(["Kyodai 3.0","Kyodai 6.0"].includes(e)){const o=(n[1]||"").split("::"),a=o[0]||"",s=o[1]||"uncategorized",l=n[2]||"",c=yield function q(i,r){return v.apply(this,arguments)}(a,l);return c.cat=s||c.cat,c}return Promise.reject(Error(`Unknown .lay format ${JSON.stringify((e||"").slice(0,50))}`))}),x.apply(this,arguments)}function Y(i){const r={};(function K(i){return i.sort((r,n)=>r[0]<n[0]?-1:r[0]>n[0]?1:r[1]<n[1]?-1:r[1]>n[1]?1:r[2]<n[2]?-1:r[2]>n[2]?1:0)})(i).forEach(e=>{r[e[0]]=r[e[0]]||{},r[e[0]][e[2]]=r[e[0]][e[2]]||[],r[e[0]][e[2]].push(e[1])});const n=[];for(const e of Object.keys(r)){const o=[];for(const a of Object.keys(r[Number(e)])){const s=r[Number(e)][Number(a)],l=[];let c={start:-1,current:-1,count:0};s.forEach(u=>{u!==c.current?(c={start:u,current:u+2,count:1},l.push(c)):(c.current+=2,c.count++)});const d=l.map(u=>1===u.count?u.start:[u.start,u.count]);1!==d.length||Array.isArray(d[0])?o.push([Number(a),d]):o.push([Number(a),d[0]])}n.push([Number(e),o])}return n}function $(i){const r=i.name.split(" by ");r.length>1&&(i.name=r[0].trim(),i.by=r[1].trim()),i.name=i.name.trim().split(" ").map(e=>e[0].toUpperCase()+e.slice(1)).join(" ").replace(/["']/g,""),i.by=i.by?i.by.trim().split(" ").map(e=>e[0].toUpperCase()+e.slice(1)).join(" ").replace(/["]/g,""):void 0;const n=P(i.mapping);return{id:(0,m.Sy)(n),name:i.name.trim(),cat:i.cat,by:i.by,map:Y(n)}}function P(i){if(0===i.length)return[];let r=i[0][0],n=i[0][1],e=i[0][2];return i.forEach(o=>{r=Math.min(o[0],r),n=Math.min(o[1],n),e=Math.min(o[2],e)}),i.map(o=>[o[0]-(r||0),o[1]-(n||0),o[2]-(e||0)])}function b(){return(b=(0,g.c)(function*(i){const r=new FileReader;return new Promise((n,e)=>{r.onload=()=>{n(r.result)},r.onerror=()=>{e(Error(`Reading File failed: ${r.error}`))},r.readAsBinaryString(i)})})).apply(this,arguments)}function z(i){return w.apply(this,arguments)}function w(){return w=(0,g.c)(function*(i){const r=yield function X(i){return b.apply(this,arguments)}(i),n=(i.name.split(".").pop()||"").toLowerCase();let e;if("lay"===n)e=$(yield function N(i,r){return x.apply(this,arguments)}(r,i.name));else{if("layout"!==n)return JSON.parse(r).boards;e=$(yield function A(i,r){return M.apply(this,arguments)}(r,i.name))}return[e]}),w.apply(this,arguments)}var k=p(5812),L=p(8952),S=p(5880);const W=(i,r)=>r.source.groupnr+"/"+r.source.v;function Q(i,r){if(1&i){const n=t.KQA();t.S2Z(),t.I0R(0,"rect",7),t.qCj("click",function(o){const s=t.usT(n).$implicit,l=t.GaO();return t.CGJ(l.onClickDraw(o,s))}),t.C$Y()}if(2&i){const n=r.$implicit;t.m8U(n.className),t.e48("x",n.pos.x)("y",n.pos.y)}}function H(i,r){if(1&i){const n=t.KQA();t.S2Z(),t.I0R(0,"g",8),t.qCj("mousedown",function(o){const s=t.usT(n).$implicit,l=t.GaO();return t.CGJ(l.onClickStone(o,s))}),t.I0R(1,"g",9),t.wR5(2,"rect",10)(3,"rect",11)(4,"use",12),t.C$Y()()}if(2&i){const n=r.$implicit;t.eAK("selected",n.source.selected)("hidden",n.source.picked)("hinted",n.source.hinted),t.e48("transform",n.pos.translate)}}let V=(()=>{class i{constructor(){this.clickBoardEvent=new t._w7,this.clickDrawEvent=new t._w7,this.clickStoneEvent=new t._w7,this.drawStones=[],this.drawCells=[],this.rotate=!1,this.translate="",this.viewport="0 0 1470 960",this.emptySource=new L._(0,0,0,0,0)}ngOnInit(){this.level&&this.updateLevel(this.level)}drawClass(n,e,o){let a="";return this.matrix.inBounds(n,e,o)||(a="invalid"),(this.matrix.isTile(n,e,o)||this.matrix.isTilePosBlocked(n,e,o))&&(a="tile"),this.matrix.isTilePosInvalid(n,e,o)&&(a="blocked"),n>0&&(this.matrix.isTile(n-1,e,o)||this.matrix.isTilePosBlocked(n-1,e,o))&&(a+=" below"),a}ngOnChanges(n){n.level&&this.updateLevel(n.level.currentValue)}onClickStone(n,e){this.clickStoneEvent.emit(e?.source),n.stopPropagation()}onClickBoard(n){this.clickBoardEvent.emit()}onClickDraw(n,e){this.clickDrawEvent.emit(e),n.stopPropagation()}calcDrawPos(n,e,o){const a={x:(_.IJ.tileWidth+2)*e/2+4,y:(_.IJ.tileHeight+2)*o/2+4,z:o+_.IJ.mY*(e+_.IJ.mX*n),translate:""};return a.translate=`translate(${a.x},${a.y})`,a}updateLevel(n){if(this.drawCells=[],this.drawStones=[],!n||!n.rows)return;const e=[];n.rows.forEach((o,a)=>{o.forEach((s,l)=>{const c={x:a,y:l,z:n.z,v:s,visible:!0,pos:this.calcDrawPos(n.z,a,l),className:this.drawClass(n.z,a,l),source:s>0?new L._(n.z,a,l,s,0):this.emptySource};this.drawCells.push(c),c.v>0&&e.push(c)})}),this.drawStones=(0,S.Ud)(e),this.viewport=(0,S.UJ)(this.drawCells,1470,960,!1)}static#t=this.\u0275fac=function(e){return new(e||i)};static#n=this.\u0275cmp=t.In1({type:i,selectors:[["app-editor-board"]],inputs:{imageSet:"imageSet",level:"level",matrix:"matrix",isBoard:"isBoard"},outputs:{clickBoardEvent:"clickBoardEvent",clickDrawEvent:"clickDrawEvent",clickStoneEvent:"clickStoneEvent"},features:[t.SYr],decls:15,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","preserveAspectRatio","xMidYMin meet",1,"board-svg",3,"mousedown"],["id","filter4198-8",2,"color-interpolation-filters","sRGB"],["in","SourceGraphic","stdDeviation","8"],["id","front","width","300","height","400","viewBox","0 0 300 400"],["d","m 151.73588,1025.0177 c -3.32683,-9.3138 -10.24843,-68.45389 5.31821,-90.62655 20.27717,-26.12032 219.43558,-16.45796 231.55506,-9.93184 11.07433,5.31702 -178.60366,0.0589 -204.85126,34.86646 -21.59349,30.0006 -26.50086,82.17843 -32.02201,65.69193 z","transform","rotate(180,229,666.5)",2,"fill","#000000","fill-opacity","0.15","fill-rule","evenodd","stroke","none","filter","url(#filter4198-8)"],["transform","translate(28,-614)","d","M -4.7687833,775.07096 C -9.6501835,741.99485 -16.84552,674.23676 -1.2788716,652.0641 18.998297,625.94378 233.50094,631.63117 263.31435,653.90999 276.21398,662.64856 70.349579,663.12124 47.099353,691.74479 24.390958,719.11242 0.65060847,818.18718 -4.7687833,775.07096 Z",2,"fill","#ffffff","fill-opacity","0.4","fill-rule","evenodd","stroke","none","filter","url(#filter4198-8)"],[1,"stage"],["stroke","black","stroke-width","1","width","37.5px","height","50px",1,"draw",3,"click"],[1,"draw",3,"mousedown"],[1,"tile"],["x","3","y","3","width","75px","height","100px","rx","10","ry","10",1,"shadow"],["x","0","y","0","width","75","height","100","rx","10","ry","10",1,"stone"],[0,"xlink","href","#front","x","0","y","0","width","75","height","100"],["stroke","black","stroke-width","1","class","draw","width","37.5px","height","50px",3,"class"],["class","draw",3,"selected","hidden","hinted"]],template:function(e,o){1&e&&(t.S2Z(),t.I0R(0,"svg",0),t.qCj("mousedown",function(s){return o.onClickBoard(s)}),t.I0R(1,"defs")(2,"filter",1),t.wR5(3,"feGaussianBlur",2),t.C$Y(),t.I0R(4,"svg",3),t.wR5(5,"path",4)(6,"path",5),t.C$Y()(),t.I0R(7,"style"),t.OEk(8," g.tile { transform-origin: 50px 32.5px; opacity: 1; } g.selected g.tile { transform: scale(1.04); } g.selected g.tile rect.stone { stroke: black; fill: #F8EABB; } g.draw rect.shadow { fill: #191919; opacity: 0.6; stroke-width: 1; stroke: black; } g.draw rect.stone { fill: #FFF9E5; stroke-width: 1; stroke: black; } g.hidden { opacity: 0; } "),t.C$Y(),t.I0R(9,"g",6),t.c53(10,Q,1,4,":svg:rect",13,t.oxv),t.C$Y(),t.I0R(12,"g",6),t.c53(13,H,5,7,":svg:g",14,W),t.C$Y()()),2&e&&(t.eAK("rotate",o.rotate)("edit",o.isBoard),t.e48("viewBox",o.viewport),t.yG2(9),t.e48("transform",o.translate),t.yG2(),t.oho(o.drawCells),t.yG2(2),t.e48("transform",o.translate),t.yG2(),t.oho(o.drawStones))},styles:["[_nghost-%COMP%]{flex:1}[_nghost-%COMP%]   .board-svg[_ngcontent-%COMP%]{height:100%;width:100%;max-height:960px;background-color:var(--main-background-color);-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .board-svg[_ngcontent-%COMP%]   g.stage[_ngcontent-%COMP%]{transition:opacity .5s}[_nghost-%COMP%]   .board-svg[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]{fill:#2b424f}[_nghost-%COMP%]   .board-svg[_ngcontent-%COMP%]   .draw.tile[_ngcontent-%COMP%]{fill:#fff9e5}[_nghost-%COMP%]   .board-svg.edit[_ngcontent-%COMP%]   .draw[_ngcontent-%COMP%]{fill:transparent;cursor:pointer}[_nghost-%COMP%]   .board-svg.edit[_ngcontent-%COMP%]   .draw.invalid[_ngcontent-%COMP%]{fill:#000;cursor:default}[_nghost-%COMP%]   .board-svg.edit[_ngcontent-%COMP%]   .draw.below[_ngcontent-%COMP%]{stroke:#d2691e;stroke-width:1px}[_nghost-%COMP%]   .board-svg.edit[_ngcontent-%COMP%]   .draw.tile[_ngcontent-%COMP%], [_nghost-%COMP%]   .board-svg.edit[_ngcontent-%COMP%]   .draw.blocked[_ngcontent-%COMP%]{fill:#0c1a1e;cursor:default}"]})}return i})();function U(i){return D([i])}function D(i){return JSON.stringify(function tt(i){return{mah:"1.0",boards:i.map(n=>j(n))}}(i))}function j(i){const r=P(i.mapping);return{id:(0,m.Sy)(r),name:i.name,by:i.by?i.by:void 0,cat:i.category?i.category:void 0,map:Y(r)}}function nt(i){const r=new h,n=(0,m.wX)(i.mapping,0,0,0);r.init(n.x+1,n.y+1,n.z),i.mapping.forEach(o=>{const a=o[0],s=o[1],l=o[2];r.setValue(a,s,l,1),r.setValue(a,s+1,l,2),r.setValue(a,s,l+1,4),r.setValue(a,s+1,l+1,3)});const e=[];return e.push("mahjongg-layout-v1.1"),e.push(`# name: ${i.name}`),e.push(`# by: ${i.by}`),e.push(`# category: ${i.category}`),e.push("# Board size in quarter tiles"),e.push(`w${n.x+1}`),e.push(`h${n.y+1}`),e.push("# Board depth"),e.push(`d${n.z}`),r.levels.forEach((o,a)=>{const s=`# Level ${a} `;e.push(`${s}${"-".repeat(Math.max(n.x-s.length,0))}`);for(let l=0;l<=n.y;l++){const c=[];for(let d=0;d<=n.x;d++)c.push(o[d][l]||".");e.push(c.join(""))}}),e.join("\n")}function it(i){return`Kyodai 6.0\n${i.name}${i.by?` by ${i.by}`:""}${i.category?` :: ${i.category}`:""}\n${function ot(i){const r=new h,a=function et(i,r,n){const e=(0,m.wX)(i,0,0,0),o=Math.max(0,Math.floor((n-e.y)/2)),a=Math.max(0,Math.floor((r-e.x)/2));return i.map(s=>[s[0],s[1]+a,s[2]+o])}(i,34,20);r.applyMapping(a,5,34,20);const s=[];for(let l=0;l<5;l++)for(let c=0;c<20;c++)for(let d=0;d<34;d++)s.push(r.get(l,d,c).toString());return s.join("")}(i.mapping)}\n`}function B(i,r,n){const e=new Blob([r],{type:n}),o=document.createElement("a");o.href=window.URL.createObjectURL(e),o.download=i,o.click()}function at(i,r){if(1&i){const n=t.KQA();t.I0R(0,"div",5)(1,"div",6)(2,"label"),t.OEk(3,"Name"),t.C$Y(),t.I0R(4,"input",7),t.qCj("input",function(o){t.usT(n);const a=t.GaO();return t.CGJ(a.layout.name=o.target.value)})("change",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.update())})("blur",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.update())}),t.C$Y(),t.I0R(5,"label"),t.OEk(6,"By"),t.C$Y(),t.I0R(7,"input",7),t.qCj("input",function(o){t.usT(n);const a=t.GaO();return t.CGJ(a.layout.by=o.target.value)})("change",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.update())})("blur",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.update())}),t.C$Y(),t.I0R(8,"label"),t.OEk(9,"Category"),t.C$Y(),t.I0R(10,"input",7),t.qCj("input",function(o){t.usT(n);const a=t.GaO();return t.CGJ(a.layout.category=o.target.value)})("change",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.update())})("blur",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.update())}),t.C$Y()(),t.I0R(11,"div",8),t.wR5(12,"app-layout-preview",9),t.C$Y()()}if(2&i){const n=t.GaO();t.yG2(4),t.E7m("value",n.layout.name),t.yG2(3),t.E7m("value",n.layout.by),t.yG2(3),t.E7m("value",n.layout.category),t.yG2(2),t.E7m("layout",n.layout)}}function st(i,r){if(1&i){const n=t.KQA();t.I0R(0,"li")(1,"input",10),t.qCj("change",function(){const a=t.usT(n).$implicit,s=t.GaO();return t.CGJ(s.chooseFormat(a))}),t.C$Y(),t.I0R(2,"label",11),t.OEk(3),t.C$Y()()}if(2&i){const n=r.$implicit,e=t.GaO();t.yG2(),t.E7m("id","format_"+n.name)("value",n)("checked",e.format===n),t.yG2(),t.E7m("for","format_"+n.name),t.yG2(),t.cNF(n.name)}}let lt=(()=>{class i{constructor(n){this.layoutService=n,this.savedEvent=new t._w7,this.exportFormats=[{name:"Mah",ext:"mah",func:U,type:"text/json"},{name:"Kyodai",ext:"lay",func:it,type:"text/lay"},{name:"Kmahjongg",ext:"layout",func:nt,type:"text/layout"}],this.format=this.exportFormats[0]}ngOnInit(){this.layout&&this.update()}ngOnChanges(n){n.layout&&this.update()}save(){const n=j(this.layout);this.layoutService.layouts.items.find(e=>!e.custom&&e.id===n.id)?alert("Similar (build-in) layout already in Game!"):(this.layoutService.layouts.items.find(e=>e.custom&&e.id===n.id)?(this.layoutService.removeCustomLayout([n.id]),this.layoutService.storeCustomBoards([n])):this.layoutService.storeCustomBoards([n]),this.savedEvent.emit())}chooseFormat(n){this.format=n,this.update()}download(){B(this.filename,this.output,this.format.type)}update(){this.layoutName=this.layout.name.toLocaleLowerCase().replace(/ /g,"_"),this.output=this.format.func(this.layout),this.filename=`${this.layoutName}.${this.format.ext}`}static#t=this.\u0275fac=function(e){return new(e||i)(t.GI1(C.O))};static#n=this.\u0275cmp=t.In1({type:i,selectors:[["app-editor-export-component"]],inputs:{layout:"layout"},outputs:{savedEvent:"savedEvent"},features:[t.SYr],decls:19,vars:3,consts:[["class","section"],[1,"export"],[1,"export-preview"],[1,"buttons"],[1,"text-button",3,"click"],[1,"section"],[1,"inputs"],["type","text",3,"value","input","change","blur"],[1,"preview"],[1,"svg-board",3,"layout"],["type","radio","name","format",3,"id","value","checked","change"],[3,"for"]],template:function(e,o){1&e&&(t.I0R(0,"h3"),t.OEk(1,"Save / Export"),t.C$Y(),t.yuY(2,at,13,4,"div",0),t.I0R(3,"div",1)(4,"label"),t.OEk(5,"Format"),t.C$Y(),t.I0R(6,"fieldset")(7,"ul"),t.c53(8,st,4,5,"li",null,t.oxv),t.C$Y()(),t.I0R(10,"div",2)(11,"pre"),t.OEk(12),t.C$Y()(),t.wR5(13,"br"),t.I0R(14,"div",3)(15,"button",4),t.qCj("click",function(){return o.download()}),t.OEk(16),t.C$Y(),t.I0R(17,"button",4),t.qCj("click",function(){return o.save()}),t.OEk(18,"Save in Browser Cache"),t.C$Y()()()),2&e&&(t.yG2(2),t.C0Y(2,o.layout?2:-1),t.yG2(6),t.oho(o.exportFormats),t.yG2(4),t.cNF(o.output),t.yG2(4),t.oRS("Download ",o.filename,""))},dependencies:[k.k],styles:["[_nghost-%COMP%]{color:var(--main-text-color)}[_nghost-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;padding-top:0;text-align:center}[_nghost-%COMP%]   .preview[_ngcontent-%COMP%]{max-height:180px;min-width:100px;padding-left:10px}[_nghost-%COMP%]   .inputs[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1}[_nghost-%COMP%]   .inputs[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:4px;font-size:16px;margin-bottom:8px}@media only screen and (max-width: 400px){[_nghost-%COMP%]   .preview[_ngcontent-%COMP%]{display:none}}[_nghost-%COMP%]   .section[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .export[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;display:flex}[_nghost-%COMP%]   .export[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{vertical-align:middle;cursor:pointer}[_nghost-%COMP%]   .export[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .export[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] + li[_ngcontent-%COMP%]{margin-left:10px}[_nghost-%COMP%]   .export[_ngcontent-%COMP%]   .export-preview[_ngcontent-%COMP%]{margin-top:16px}[_nghost-%COMP%]   .export[_ngcontent-%COMP%]   .export-preview[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{white-space:pre-line;word-wrap:break-word;font-family:monospace;text-align:left;overflow:auto;min-height:180px;max-height:180px;font-size:.8em;line-height:1em;background-color:#000}[_nghost-%COMP%]   .export[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 16px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]{text-align:center;display:flex;flex-wrap:wrap}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;background-color:#0000000d;background-image:none;border:1px solid var(--dialog-border-color);cursor:pointer;color:var(--main-text-color)}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--main-text-color-hover);background-color:#0000001a;border:1px solid var(--dialog-border-color-hover)}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button.text-button[_ngcontent-%COMP%]{padding:10px 16px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{color:var(--text-disabled-color);cursor:default}"]})}return i})();const ct=i=>({selected:i}),dt=(i,r)=>({z:i,rows:r,showStones:!0});function ut(i,r){if(1&i){const n=t.KQA();t.I0R(0,"li",5),t.qCj("click",function(){const a=t.usT(n).$index,s=t.GaO(2);return t.CGJ(s.selectLevel(a))}),t.I0R(1,"div"),t.OEk(2),t.C$Y(),t.I0R(3,"div",6)(4,"app-editor-board",7),t.qCj("clickBoardEvent",function(){const a=t.usT(n).$index,s=t.GaO(2);return t.CGJ(s.selectLevel(a))}),t.C$Y()()()}if(2&i){const n=r.$implicit,e=r.$index,o=t.GaO(2);t.E7m("ngClass",t.S45(4,ct,e===o.currentZ)),t.yG2(2),t.oRS("Level ",e,""),t.yG2(2),t.E7m("level",t.IBC(6,dt,e,n))("matrix",o.matrix)}}function pt(i,r){if(1&i&&(t.I0R(0,"div",3)(1,"ul",4),t.c53(2,ut,5,9,"li",8,t.oxv),t.C$Y()()),2&i){const n=t.GaO();t.yG2(2),t.oho(n.matrix.levels)}}function _t(i,r){if(1&i&&(t.I0R(0,"div",45),t.S2Z(),t.I0R(1,"svg",46)(2,"g",47),t.wR5(3,"path",48),t.C$Y(),t.I0R(4,"text",49),t.OEk(5),t.C$Y(),t.I0R(6,"text",50),t.OEk(7),t.C$Y(),t.I0R(8,"text",51),t.OEk(9),t.C$Y()()()),2&i){const n=t.GaO(2);t.yG2(5),t.CAO("x",n.stats.minX," \u2026 x",n.stats.maxX,""),t.yG2(2),t.CAO("z",n.stats.minZ," \u2026 z",n.stats.maxZ,""),t.yG2(2),t.CAO("y",n.stats.minY," \u2026 y",n.stats.maxY,"")}}function gt(i,r){if(1&i){const n=t.KQA();t.I0R(0,"button",52),t.qCj("click",function(){t.usT(n);const o=t.GaO(2);return t.CGJ(o.solve())}),t.OEk(1," Test Solvable "),t.C$Y()}}function Ct(i,r){if(1&i){const n=t.KQA();t.I0R(0,"button",52),t.qCj("click",function(){t.usT(n);const o=t.GaO(2);return t.CGJ(o.cancelSolve())}),t.OEk(1," Cancel Solve "),t.C$Y()}}function mt(i,r){if(1&i&&(t.I0R(0,"div")(1,"div"),t.OEk(2),t.C$Y(),t.I0R(3,"div"),t.OEk(4,"Fail: "),t.I0R(5,"span"),t.OEk(6),t.C$Y()()()),2&i){const n=t.GaO(2);t.yG2(2),t.oRS("Win: ",n.solveStats.won,""),t.yG2(3),t.eAK("fail",n.solveStats.fail>0),t.yG2(),t.cNF(n.solveStats.fail)}}function ht(i,r){if(1&i){const n=t.KQA();t.I0R(0,"div",9)(1,"div",10)(2,"div",11)(3,"div",12)(4,"div",13),t.OEk(5),t.C$Y(),t.I0R(6,"div",14)(7,"span"),t.OEk(8),t.C$Y(),t.I0R(9,"button",15),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.moveLayerY(-1))}),t.wR5(10,"i",16),t.C$Y(),t.I0R(11,"button",17),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.moveLayerY(1))}),t.wR5(12,"i",18),t.C$Y(),t.I0R(13,"button",19),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.moveLayerX(-1))}),t.wR5(14,"i",20),t.C$Y(),t.I0R(15,"button",21),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.moveLayerX(1))}),t.wR5(16,"i",22),t.C$Y()()(),t.I0R(17,"div",23)(18,"app-editor-board",24),t.qCj("clickDrawEvent",function(o){t.usT(n);const a=t.GaO();return t.CGJ(a.onCellClick(o))})("clickStoneEvent",function(o){t.usT(n);const a=t.GaO();return t.CGJ(a.onStoneClick(o))}),t.C$Y()(),t.I0R(19,"div",12)(20,"div",14)(21,"button",25),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.newLayerBelow(o.currentZ))}),t.wR5(22,"i",26),t.C$Y(),t.I0R(23,"button",27),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.moveLayerZ(-1,o.currentZ))}),t.wR5(24,"i",16),t.C$Y(),t.I0R(25,"button",28),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.moveLayerZ(1,o.currentZ))}),t.wR5(26,"i",18),t.C$Y(),t.I0R(27,"button",29),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.duplicateLayerZ(o.currentZ))}),t.wR5(28,"i",30),t.C$Y(),t.I0R(29,"button",31),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.clearLayerZ(o.currentZ))}),t.wR5(30,"i",32),t.C$Y(),t.I0R(31,"button",33),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.deleteLayerZ(o.currentZ))}),t.wR5(32,"i",34),t.C$Y()()()(),t.I0R(33,"div",35)(34,"div",12),t.wR5(35,"div",14),t.I0R(36,"div",14)(37,"span"),t.OEk(38),t.C$Y(),t.I0R(39,"button",36),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.moveY(-1))}),t.wR5(40,"i",16),t.C$Y(),t.I0R(41,"button",37),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.moveY(1))}),t.wR5(42,"i",18),t.C$Y(),t.I0R(43,"button",38),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.moveX(-1))}),t.wR5(44,"i",20),t.C$Y(),t.I0R(45,"button",39),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.moveX(1))}),t.wR5(46,"i",22),t.C$Y()()(),t.I0R(47,"div",40),t.wR5(48,"app-layout-preview",41),t.yuY(49,_t,10,6,"div",42),t.C$Y(),t.I0R(50,"div",43)(51,"div",14)(52,"div"),t.yuY(53,gt,2,0,"button",44)(54,Ct,2,0,"button",44),t.C$Y()(),t.yuY(55,mt,7,4,"div"),t.C$Y()()()()}if(2&i){const n=t.GaO();t.yG2(5),t.oRS("Level ",n.currentZ,""),t.yG2(3),t.oRS("Tiles: ",n.stats.layerCount,""),t.yG2(10),t.E7m("level",n.level)("isBoard",!0)("matrix",n.matrix),t.yG2(5),t.E7m("disabled",0===n.currentZ),t.yG2(2),t.E7m("disabled",n.currentZ===n.matrix.levels.length-1),t.yG2(12),t.eAK("fail",n.stats.countInvalid),t.yG2(),t.oRS("Tiles: ",n.stats.totalCount,""),t.yG2(10),t.E7m("svg",n.svg),t.yG2(),t.C0Y(49,n.stats?49:-1),t.yG2(4),t.C0Y(53,n.solveWorker?-1:53),t.yG2(),t.C0Y(54,n.solveWorker?54:-1),t.yG2(),t.C0Y(55,n.solveStats?55:-1)}}function ft(i,r){if(1&i){const n=t.KQA();t.I0R(0,"div",53),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.toggleSave())}),t.I0R(1,"div",54),t.qCj("click",function(o){return o.stopPropagation()}),t.I0R(2,"span",55),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.toggleSave())}),t.wR5(3,"i",56),t.C$Y(),t.I0R(4,"app-editor-export-component",57),t.qCj("savedEvent",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.toggleSave())}),t.C$Y()()()}if(2&i){const n=t.GaO();t.yG2(4),t.E7m("layout",n.layout)}}let Z=(()=>{class i{constructor(n,e){this.worker=n,this.layoutService=e,this.currentZ=0,this.totalZ=1,this.totalY=_.IJ.mY,this.totalX=_.IJ.mX,this.matrix=new h,this.saveDialog=!1}ngOnDestroy(){this.cancelSolve()}getStats(n){const e={name:n.name,totalCount:n.mapping.length,layerCount:n.mapping.filter(o=>o[0]===this.currentZ).length,countInvalid:n.mapping.length>144||!!(n.mapping.length%2),minX:100,maxX:0,minY:100,maxY:0,minZ:100,maxZ:0,height:0,width:0,depth:0};return n.mapping.forEach(o=>{o[0]<e.minZ&&(e.minZ=o[0]),o[0]>e.maxZ&&(e.maxZ=o[0]),o[1]<e.minX&&(e.minX=o[1]),o[1]>e.maxX&&(e.maxX=o[1]),o[2]<e.minY&&(e.minY=o[2]),o[2]>e.maxY&&(e.maxY=o[2])}),e.width=e.maxX-e.minX,e.height=e.maxY-e.minY,e.depth=e.maxZ-e.minZ,e}ngOnInit(){this.layout&&this.refresh()}ngOnChanges(n){n.layout&&this.refresh()}onPosClick(n,e,o){this.matrix.isTilePosBlocked(n,e,o)||this.matrix.isTilePosInvalid(n,e,o)||(this.matrix.isTile(n,e,o)?this.layout.mapping=this.layout.mapping.filter(a=>a[0]!==n||a[1]!==e||a[2]!==o):this.layout.mapping.push([n,e,o]),this.refresh())}onCellClick(n){this.onPosClick(n.z,n.x,n.y)}onStoneClick(n){n&&this.onPosClick(n.z,n.x,n.y)}selectLevel(n){this.level={z:n,rows:this.matrix.levels[n],showTiles:!0},this.currentZ=n,this.refresh()}refresh(){this.matrix.applyMapping(this.layout.mapping,this.totalZ,this.totalX,this.totalY),this.stats=this.getStats(this.layout),this.level={z:this.currentZ,rows:this.matrix.levels[this.currentZ],showTiles:!0},this.svg=this.layoutService.generatePreview(P(this.layout.mapping)),this.layout.previewSVG=this.svg}moveX(n){this.stats.minX+n<0||this.stats.maxX+n>=_.IJ.mX-1||(this.layout.mapping.forEach(e=>e[1]=e[1]+n),this.refresh())}moveY(n){this.stats.minY+n<0||this.stats.maxY+n>=_.IJ.mY-1||(this.layout.mapping.forEach(e=>e[2]=e[2]+n),this.refresh())}moveLayerX(n){const e=this.layout.mapping.filter(s=>s[0]===this.currentZ);let o=e[0][1],a=e[0][1];e.forEach(s=>{o=Math.min(s[1],o),a=Math.max(s[1],a)}),!(o+n<0||a+n>=_.IJ.mX-1)&&(e.forEach(s=>s[1]=s[1]+n),this.refresh())}moveLayerY(n){const e=this.layout.mapping.filter(s=>s[0]===this.currentZ);let o=e[0][2],a=e[0][2];e.forEach(s=>{o=Math.min(s[2],o),a=Math.max(s[2],a)}),!(o+n<0||a+n>=_.IJ.mY-1)&&(e.forEach(s=>s[2]=s[2]+n),this.refresh())}duplicateLayerZ(n){const e=[];this.layout.mapping.forEach(o=>{o[0]>n?o[0]=o[0]+1:o[0]===n&&e.push(o)}),e.forEach(o=>{this.layout.mapping.push([n+1,o[1],o[2]])}),this.refresh()}clearLayerZ(n){this.layout.mapping=this.layout.mapping.filter(e=>e[0]!==n),this.refresh()}deleteLayerZ(n){this.layout.mapping=this.layout.mapping.filter(e=>e[0]!==n),this.layout.mapping.forEach(e=>{e[0]>n&&(e[0]=e[0]-1)}),this.totalZ=Math.max(this.totalZ-1,1),this.refresh()}newLayerBelow(n){this.totalZ+=1,this.layout.mapping.forEach(e=>{e[0]>n&&(e[0]=e[0]+1)}),this.refresh()}moveLayerZ(n,e){e+n<0||e+n>=this.matrix.levels.length||(this.layout.mapping.forEach(o=>{o[0]===e?o[0]=o[0]+n:o[0]===e+n&&(o[0]=e)}),e===this.currentZ&&(this.currentZ=this.currentZ+n),this.refresh())}toggleSave(){this.saveDialog=!this.saveDialog}cancelSolve(){this.solveWorker&&(this.solveWorker.terminate(),this.solveWorker=void 0)}solve(){if(this.solveWorker)return;const n={fail:0,won:0};this.solveWorker=this.worker.solve(this.layout.mapping,1e3,e=>{n.won=e[0],n.fail=e[1]},e=>{n.won=e[0],n.fail=e[1],this.solveWorker=void 0}),this.solveStats=n}static#t=this.\u0275fac=function(e){return new(e||i)(t.GI1(R.s),t.GI1(C.O))};static#n=this.\u0275cmp=t.In1({type:i,selectors:[["app-editor-layout-component"]],inputs:{layout:"layout"},features:[t.SYr],decls:3,vars:3,consts:[["class","editor-matrix-list"],["class","editor-selected"],["class","overlay overlay-save"],[1,"editor-matrix-list"],[1,"matrix-list"],[3,"ngClass","click"],[1,"matrix-level"],[3,"level","matrix","clickBoardEvent"],[3,"ngClass"],[1,"editor-selected"],[1,"matrix-edit"],[1,"matrix-edit-top"],[1,"buttonbar"],[1,"buttonbar-title"],[1,"buttons"],["title","Move tiles up",3,"click"],[1,"icon-editor-up-small"],["title","Move tiles down",3,"click"],[1,"icon-editor-down-small"],["title","Move tiles left",3,"click"],[1,"icon-editor-left-small"],["title","Move tiles right",3,"click"],[1,"icon-editor-right-small"],[1,"matrix-board"],[3,"level","isBoard","matrix","clickDrawEvent","clickStoneEvent"],["title","New Level below",3,"click"],[1,"icon-editor-list-add"],["title","Move Level down",3,"disabled","click"],["title","Move Level up",3,"disabled","click"],["title","Duplicate Level",3,"click"],[1,"icon-editor-docs"],["title","Clear Level",3,"click"],[1,"icon-editor-cancel-alt"],["title","Delete Level",3,"click"],[1,"icon-editor-trash"],[1,"matrix-edit-bottom"],["title","Move all tiles up",3,"click"],["title","Move all tiles down",3,"click"],["title","Move all tiles left",3,"click"],["title","Move all tiles right",3,"click"],[1,"matrix-preview"],[1,"svg-board",3,"svg"],["class","dimensions"],[1,"stats","stats-bottom"],["class","text-button"],[1,"dimensions"],["xmlns","http://www.w3.org/2000/svg","height","100%","width","100%","x","0px","y","0px","viewBox","0 0 1600 1500"],["transform","translate(0, 300)"],["fill","#47b00a","d","M10,309.7c40.7-99.4,81.5-198.7,122.3-298c39.6,99.2,78.6,198.7,117.9,298c-31.6,0.1-63.2,0-94.8,0.1c0,167-0.1,334.1,0,501.1c148.5-103.4,296.4-207.8,444.8-311.4c-16.9-26.8-37-51.7-53.8-78.5c102.1-22.8,204.1-46,306.2-69C795.4,439.2,738,526.3,680.3,613.2c-17.6-25.2-35.1-50.4-52.9-75.4C480.9,640,334.5,742.4,188.5,845.4c167.8,0.3,335.6,0.1,503.4,0.1c0.1-32.5-0.1-64.9,0.1-97.3c99.4,40.7,198.7,81.5,298,122.3C890.8,910,791.3,949,691.9,988.3c-0.1-31.6,0-63.2-0.1-94.8c-193.7-0.1-387.4-0.1-581.1,0c-1.2,0-2.3-0.5-3.5-0.8c0.1-194.3,0.1-388.6,0-582.9C74.9,309.7,42.5,309.8,10,309.7L10,309.7z"],["x","100","y","1500","fill","#47b00a",2,"font","200px monospace"],["x","0","y","200","fill","#47b00a",2,"font","200px monospace"],["x","600","y","500","fill","#47b00a",2,"font","200px monospace"],[1,"text-button",3,"click"],[1,"overlay","overlay-save",3,"click"],[1,"overlay-popup",3,"click"],[1,"close",3,"click"],[1,"icon-cancel-circled2","pull-right"],[3,"layout","savedEvent"]],template:function(e,o){1&e&&t.yuY(0,pt,4,0,"div",0)(1,ht,56,15,"div",1)(2,ft,5,1,"div",2),2&e&&(t.C0Y(0,o.layout?0:-1),t.yG2(),t.C0Y(1,o.layout?1:-1),t.yG2(),t.C0Y(2,o.saveDialog?2:-1))},dependencies:[G.QF,k.k,V,lt],styles:["[_nghost-%COMP%]{display:flex;flex:1;flex-direction:row;color:var(--main-text-color);overflow:hidden}[_nghost-%COMP%]   .save-button[_ngcontent-%COMP%]{position:fixed;right:50px;top:6px}[_nghost-%COMP%]   .overlay-save[_ngcontent-%COMP%]   .overlay-popup[_ngcontent-%COMP%]{width:98%;height:98%;max-height:640px;max-width:640px;overflow-y:auto}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{padding-right:6px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .fail[_ngcontent-%COMP%]{color:var(--text-fail-color)}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;background-image:none;color:var(--text-highlight-color);border:1px solid var(--main-bg-color-dk);cursor:pointer}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--main-text-color-hover);border:1px solid var(--main-bg-color-lt)}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button.text-button[_ngcontent-%COMP%]{padding:10px 16px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{color:var(--text-disabled-color);cursor:default}[_nghost-%COMP%]   .buttonbar[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}[_nghost-%COMP%]   .buttonbar[_ngcontent-%COMP%]   .buttonbar-title[_ngcontent-%COMP%]{padding-left:12px}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]{width:220px;max-height:100%;height:100%;border-right:1px solid var(--dialog-border-color);overflow-y:auto}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]   .matrix-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:4px;max-height:100%}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]   .matrix-list[_ngcontent-%COMP%]   .matrix-level[_ngcontent-%COMP%]{display:flex;max-width:80%;margin:0 auto}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]   .matrix-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{text-align:center;cursor:pointer;border:1px solid var(--dialog-border-color);margin-bottom:4px;display:flex;flex-direction:column;overflow:hidden}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]   .matrix-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{border-color:var(--dialog-border-color-hover)}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]   .matrix-list[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%]{border-color:var(--dialog-border-color-selected)}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]   .matrix-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;display:inline-block;min-width:.8em}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:auto}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .editor-commands[_ngcontent-%COMP%]{border-bottom:1px solid #ececec;padding-bottom:10px}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .editor-commands[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{font-size:.9em;display:inline-block;vertical-align:top;margin-right:10px}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .editor-commands[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{cursor:pointer;text-decoration:underline;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;text-align:center;max-height:100%;overflow:hidden}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-top[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;overflow:hidden}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-top[_ngcontent-%COMP%]   .matrix-board[_ngcontent-%COMP%]{flex:1;display:flex;overflow:hidden}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-bottom[_ngcontent-%COMP%]{border-top:1px solid var(--dialog-border-color);height:25%;display:flex;flex-direction:column;position:relative;min-height:120px}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-bottom[_ngcontent-%COMP%]   .matrix-preview[_ngcontent-%COMP%]{position:relative;overflow:hidden}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-bottom[_ngcontent-%COMP%]   .matrix-preview[_ngcontent-%COMP%]   .dimensions[_ngcontent-%COMP%]{opacity:0;background-color:#000000b3;position:absolute;padding:8px;inset:0}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-bottom[_ngcontent-%COMP%]   .matrix-preview[_ngcontent-%COMP%]:hover   .dimensions[_ngcontent-%COMP%]{opacity:1}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-bottom[_ngcontent-%COMP%]   .stats[_ngcontent-%COMP%]{position:absolute;background-color:#000000b3;bottom:0;font-size:.9em;border-radius:6px;text-align:left;padding:10px;font-variant-numeric:slashed-zero tabular-nums}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-bottom[_ngcontent-%COMP%]   .stats-bottom[_ngcontent-%COMP%]{text-align:right;right:0}@media only screen and (max-width: 700px){[_nghost-%COMP%]{flex-direction:column}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]{height:80px;width:100%;overflow:auto hidden;margin-bottom:2px;border-right:none;border-bottom:1px solid var(--dialog-border-color)}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]   .matrix-list[_ngcontent-%COMP%]{white-space:nowrap;border-right:none;height:92%}[_nghost-%COMP%]   .editor-matrix-list[_ngcontent-%COMP%]   .matrix-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{width:100px;height:100%;display:inline-flex}}@media only screen and (width >= 400px) and (height <= 600px){[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]{flex-direction:row}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-top[_ngcontent-%COMP%]{max-height:100%}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-bottom[_ngcontent-%COMP%]{height:100%;width:30%;border-top:none}[_nghost-%COMP%]   .editor-selected[_ngcontent-%COMP%]   .matrix-edit[_ngcontent-%COMP%]   .matrix-edit-bottom[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}}"]})}return i})();function vt(i,r){if(1&i){const n=t.KQA();t.I0R(0,"button",21),t.qCj("click",function(o){t.usT(n);const a=t.GaO().$implicit,s=t.GaO();return t.CGJ(s.removeCustomBoard(o,a))}),t.wR5(1,"i",10),t.C$Y()}}function Ot(i,r){if(1&i&&(t.I0R(0,"div"),t.OEk(1),t.C$Y()),2&i){const n=t.GaO(2).$implicit,e=t.GaO();t.yG2(),t.oRS("Win: ",e.test[n.id].win,"")}}function yt(i,r){if(1&i&&(t.I0R(0,"div",23),t.OEk(1),t.C$Y()),2&i){const n=t.GaO(2).$implicit,e=t.GaO();t.yG2(),t.oRS("Fail: ",e.test[n.id].fail,"")}}function Mt(i,r){if(1&i&&(t.I0R(0,"div"),t.yuY(1,Ot,2,1,"div")(2,yt,2,1,"div",22),t.C$Y()),2&i){const n=t.GaO().$implicit,e=t.GaO();t.yG2(),t.C0Y(1,e.test[n.id].win?1:-1),t.yG2(),t.C0Y(2,e.test[n.id].fail?2:-1)}}function xt(i,r){if(1&i){const n=t.KQA();t.I0R(0,"div",14),t.qCj("click",function(){const a=t.usT(n).$implicit,s=t.GaO();return t.CGJ(s.editLayout(a))}),t.I0R(1,"div",2),t.wR5(2,"app-layout-preview",15),t.C$Y(),t.I0R(3,"div",16),t.OEk(4),t.C$Y(),t.I0R(5,"div",17),t.OEk(6),t.C$Y(),t.I0R(7,"div",18),t.OEk(8),t.C$Y(),t.I0R(9,"div",19),t.OEk(10),t.C$Y(),t.I0R(11,"div",8),t.yuY(12,vt,2,0,"button",20),t.C$Y(),t.I0R(13,"div",11),t.yuY(14,Mt,3,2,"div"),t.C$Y()()}if(2&i){const n=r.$implicit,e=t.GaO();t.yG2(2),t.E7m("layout",n),t.yG2(2),t.cNF(n.name),t.yG2(2),t.cNF(n.by),t.yG2(2),t.cNF(n.category),t.yG2(2),t.cNF(n.mapping.length),t.yG2(2),t.C0Y(12,n.custom?12:-1),t.yG2(2),t.C0Y(14,e.test[n.id]?14:-1)}}let Pt=(()=>{class i{constructor(n,e){this.layoutService=n,this.workerService=e,this.test={},this.sortColumn=1,this.sortDesc=!0,this.editEvent=new t._w7,this.update()}ngOnChanges(n){n.inputLayouts&&this.update()}ngOnDestroy(){this.worker&&(this.worker.terminate(),this.worker=void 0)}editLayout(n){this.editEvent.emit(n)}clickSortBy(n,e){this.sortColumn===e&&(this.sortDesc=!this.sortDesc),this.sortBy(e)}update(){this.inputLayouts&&(this.layouts=this.inputLayouts.sort((n,e)=>n.name.localeCompare(e.name)),this.sortBy(this.sortColumn))}removeCustomBoard(n,e){n.stopPropagation(),this.layoutService.removeCustomLayout([e.id]),this.update()}removeCustomLayouts(n){n.stopPropagation(),this.layoutService.removeAllCustomLayouts(),this.update()}sortBy(n){this.sortColumn=n,this.layouts=this.layouts.sort((e,o)=>{let a;switch(n){case 1:a=e.name.localeCompare(o.name);break;case 2:a=(e.by||"").localeCompare(o.by||"");break;case 3:a=(e.category||"").localeCompare(o.category||"");break;case 4:a=e.mapping.length-o.mapping.length;break;default:a=0}return(this.sortDesc?1:-1)*a})}testLayouts(n){this.worker?this.worker.terminate():this.testNextLayout()}testNextLayout(){const n=this.layouts.find(e=>!this.test[e.id]);n&&(this.worker=this.workerService.solve(n.mapping,10,e=>{this.test[n.id]={win:e[0],fail:e[1]}},e=>{this.test[n.id]={win:e[0],fail:e[1]},this.testNextLayout(),this.worker=void 0}))}static#t=this.\u0275fac=function(e){return new(e||i)(t.GI1(C.O),t.GI1(R.s))};static#n=this.\u0275cmp=t.In1({type:i,selectors:[["app-manager-component"]],inputs:{inputLayouts:"inputLayouts"},outputs:{editEvent:"editEvent"},features:[t.SYr],decls:26,vars:16,consts:[[1,"layout-table"],[1,"layout","layout-header"],[1,"col-image"],[1,"col-name","sortable",3,"click"],[1,"arrow"],[1,"col-by","sortable",3,"click"],[1,"col-cat","sortable",3,"click"],[1,"col-stats","sortable",3,"click"],[1,"col-clear"],["title","Remove all custom layouts",3,"click"],[1,"icon-trash-empty"],[1,"col-test"],["title","Test all layouts",3,"click"],[1,"icon-editor-ok"],[1,"layout",3,"click"],[1,"svg-board",3,"layout"],[1,"col-name"],[1,"col-by"],[1,"col-cat"],[1,"col-stats"],["title","Remove this layouts"],["title","Remove this layouts",3,"click"],["class","fail"],[1,"fail"],["class","layout"]],template:function(e,o){1&e&&(t.I0R(0,"div",0)(1,"div",1)(2,"div",2),t.OEk(3,"Preview"),t.C$Y(),t.I0R(4,"div",3),t.qCj("click",function(s){return o.clickSortBy(s,1)}),t.OEk(5,"Name "),t.wR5(6,"span",4),t.C$Y(),t.I0R(7,"div",5),t.qCj("click",function(s){return o.clickSortBy(s,2)}),t.OEk(8,"by "),t.wR5(9,"span",4),t.C$Y(),t.I0R(10,"div",6),t.qCj("click",function(s){return o.clickSortBy(s,3)}),t.OEk(11,"Category "),t.wR5(12,"span",4),t.C$Y(),t.I0R(13,"div",7),t.qCj("click",function(s){return o.clickSortBy(s,4)}),t.OEk(14,"# of Stones "),t.wR5(15,"span",4),t.C$Y(),t.I0R(16,"div",8),t.OEk(17," Clear "),t.I0R(18,"button",9),t.qCj("click",function(s){return o.removeCustomLayouts(s)}),t.wR5(19,"i",10),t.C$Y()(),t.I0R(20,"div",11),t.OEk(21,"Test "),t.I0R(22,"button",12),t.qCj("click",function(s){return o.testLayouts(s)}),t.wR5(23,"i",13),t.C$Y()()(),t.c53(24,xt,15,7,"div",24,t.oxv),t.C$Y()),2&e&&(t.yG2(4),t.eAK("sort-up",1===o.sortColumn&&o.sortDesc)("sort-down",1===o.sortColumn&&!o.sortDesc),t.yG2(3),t.eAK("sort-up",2===o.sortColumn&&o.sortDesc)("sort-down",2===o.sortColumn&&!o.sortDesc),t.yG2(3),t.eAK("sort-up",3===o.sortColumn&&o.sortDesc)("sort-down",3===o.sortColumn&&!o.sortDesc),t.yG2(3),t.eAK("sort-up",4===o.sortColumn&&o.sortDesc)("sort-down",4===o.sortColumn&&!o.sortDesc),t.yG2(11),t.oho(o.layouts))},dependencies:[k.k],styles:["[_nghost-%COMP%]{overflow-y:auto;flex:1;display:flex}[_nghost-%COMP%]   .fail[_ngcontent-%COMP%]{color:var(--text-fail-color)}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]{display:table;color:var(--main-text-color);width:100%}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%]{display:table-row;cursor:pointer}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%]:hover{background-color:#ffffff05}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle;padding:4px 15px;border-top:1px solid var(--dialog-border-color);border-right:1px solid var(--dialog-border-color)}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-bottom:5px solid var(--main-text-color);display:none;margin-bottom:3px}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%] > div.sortable[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%] > div.sort-up[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%] > div.sort-down[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{display:inline-block;transform:rotate(180deg)}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%]   .col-image[_ngcontent-%COMP%]{width:80px;height:80px}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout[_ngcontent-%COMP%]   .col-id[_ngcontent-%COMP%]{font-variant-numeric:slashed-zero tabular-nums}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .col-stats[_ngcontent-%COMP%], [_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .col-clear[_ngcontent-%COMP%]{max-width:50px}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .col-test[_ngcontent-%COMP%]{max-width:80px}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout-header[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-top:none}[_nghost-%COMP%]   .layout-table[_ngcontent-%COMP%]   .layout-header[_ngcontent-%COMP%]:hover{background-color:#0000001a}[_nghost-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;background-image:none;color:var(--text-highlight-color);border:1px solid var(--main-bg-color-dk);cursor:pointer;text-align:center}[_nghost-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--main-text-color-hover);border:1px solid var(--main-bg-color-lt)}[_nghost-%COMP%]   button.text-button[_ngcontent-%COMP%]{padding:10px 16px}[_nghost-%COMP%]   button[disabled][_ngcontent-%COMP%]{color:var(--text-disabled-color);cursor:default}"]})}return i})(),F=(()=>{class i{constructor(){this.appDropZone=new t._w7,this.appDropZoneOver=new t._w7,this.preventBodyDrop=!0,this.active=!1}onDrop(n){n.preventDefault(),this.active=!1;const{dataTransfer:e}=n;if(e?.items){const o=[];for(let a=0;a<e.items.length;a++)if(e.items[a]&&"file"===e.items[a].kind){const s=e.items[a].getAsFile();null!=s&&o.push(s)}e.items.clear(),this.appDropZone.emit(o)}else if(e){const o=e?.files;e.clearData(),o&&this.appDropZone.emit(Array.from(o))}}onDragOver(n){n.stopPropagation(),n.preventDefault(),this.active||this.appDropZoneOver.emit(),this.active=!0}onDragLeave(n){this.active=!1}onBodyDragOver(n){this.preventBodyDrop&&(n.preventDefault(),n.stopPropagation())}onBodyDrop(n){this.preventBodyDrop&&n.preventDefault()}static#t=this.\u0275fac=function(e){return new(e||i)};static#n=this.\u0275dir=t.Sc5({type:i,selectors:[["","appDropZone",""]],hostVars:2,hostBindings:function(e,o){1&e&&t.qCj("drop",function(s){return o.onDrop(s)})("dragover",function(s){return o.onDragOver(s)})("dragleave",function(s){return o.onDragLeave(s)})("dragover",function(s){return o.onBodyDragOver(s)},!1,t.mKV)("drop",function(s){return o.onBodyDrop(s)},!1,t.mKV),2&e&&t.eAK("drop-zone-active",o.active)},inputs:{preventBodyDrop:"preventBodyDrop"},outputs:{appDropZone:"appDropZone",appDropZoneOver:"appDropZoneOver"}})}return i})();function bt(i,r){if(1&i){const n=t.KQA();t.I0R(0,"a",6),t.qCj("click",function(){t.usT(n);const o=t.GaO().$implicit,a=t.GaO();return t.CGJ(a.selectLayout(o.id))}),t.wR5(1,"i",7),t.OEk(2),t.C$Y()}if(2&i){const n=t.GaO().$implicit;t.yG2(2),t.oRS(" ",n.msg,"")}}function wt(i,r){if(1&i&&t.OEk(0),2&i){const n=t.GaO().$implicit;t.oRS(" ",n.msg," ")}}function kt(i,r){if(1&i&&(t.I0R(0,"p",5),t.yuY(1,bt,3,1,"a")(2,wt,1,1),t.C$Y()),2&i){const n=r.$implicit;t.eAK("is-error",n.isError),t.yG2(),t.C0Y(1,n.id?1:-1),t.yG2(),t.C0Y(2,n.id?-1:2)}}let Et=(()=>{class i{constructor(n){this.layoutService=n,this.editEvent=new t._w7,this.logs=[]}selectFiles(n){const o=n.currentTarget.files;o&&this.importFiles(Array.from(o))}importLayouts(n){var e=this;return(0,g.c)(function*(){e.logs=[];const o=[];for(const a of n)try{(yield z(a)).forEach(l=>{const c=e.layoutService.expandLayout(l,!0);e.layoutService.layouts.items.find(d=>d.id===c.id)||o.find(d=>d.id===c.id)?(console.error(`Similar layout to "${c.name}" already available. Import rejected`),e.logs.push({msg:`Similar layout to "${c.name}" already available. Import rejected.`,isError:!0})):(o.push({id:c.id,name:c.name,by:c.by,cat:c.category,map:l.map}),e.logs.push({msg:`Imported: "${a.name}"`,id:c.id}))})}catch(s){console.error("Error importing",a,s),e.logs.push({msg:`ERROR importing "${a.name}". Invalid file.`,isError:!0})}o.length>0&&e.layoutService.storeCustomBoards(o)})()}selectLayout(n){const e=this.layoutService.layouts.items.find(o=>o.id===n);e&&this.editEvent.emit(e)}importFiles(n){this.importLayouts(n).catch(e=>{console.error(e)})}onDropFiles(n){this.importFiles(n)}static#t=this.\u0275fac=function(e){return new(e||i)(t.GI1(C.O))};static#n=this.\u0275cmp=t.In1({type:i,selectors:[["app-import-component"]],outputs:{editEvent:"editEvent"},decls:15,vars:0,consts:[[1,"import-section",3,"appDropZone"],[1,"drop-zone"],[1,"title"],["name","file","type","file","multiple","",3,"change"],[1,"log-zone"],[1,"layout"],[3,"click"],[1,"icon-editor-ok"],["class","layout",3,"is-error"]],template:function(e,o){1&e&&(t.I0R(0,"div",0),t.qCj("appDropZone",function(s){return o.onDropFiles(s)}),t.I0R(1,"div",1)(2,"div",2),t.OEk(3,"Drag your files here"),t.wR5(4,"br"),t.OEk(5," *.lay (Kyodai text format)"),t.wR5(6,"br"),t.OEk(7," *.layout (kmahjongg text format)"),t.wR5(8,"br"),t.OEk(9," *.mah (Mah json format)"),t.wR5(10,"br"),t.C$Y(),t.I0R(11,"input",3),t.qCj("change",function(s){return o.selectFiles(s)}),t.C$Y()(),t.I0R(12,"div",4),t.c53(13,kt,3,4,"p",8,t.oxv),t.C$Y()()),2&e&&(t.yG2(13),t.oho(o.logs))},dependencies:[F],styles:["[_nghost-%COMP%]{flex:1;display:flex;color:var(--main-text-color);width:100%}[_nghost-%COMP%]   .import-section[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;flex-direction:column;width:100%}[_nghost-%COMP%]   .import-section[_ngcontent-%COMP%]   .drop-zone[_ngcontent-%COMP%]{padding:80px 30px;width:100%;max-width:800px;border:2px dashed var(--dialog-border-color);border-radius:20px;text-align:center;position:relative}[_nghost-%COMP%]   .import-section[_ngcontent-%COMP%]   .log-zone[_ngcontent-%COMP%]{margin-top:20px;max-height:300px;width:100%;max-width:800px;color:var(--main-text-color);overflow-y:auto}[_nghost-%COMP%]   .import-section[_ngcontent-%COMP%]   .log-zone[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   .import-section[_ngcontent-%COMP%]   .log-zone[_ngcontent-%COMP%]   p.is-error[_ngcontent-%COMP%]{color:var(--text-fail-color)}[_nghost-%COMP%]   .import-section.drop-zone-active[_ngcontent-%COMP%]   .drop-zone[_ngcontent-%COMP%]{border:2px dashed var(--dialog-border-color)}"]})}return i})();function Gt(i,r){if(1&i){const n=t.KQA();t.I0R(0,"div")(1,"div",9)(2,"ul")(3,"li"),t.OEk(4,"Mah Editor: Import"),t.C$Y()()(),t.I0R(5,"div",10)(6,"app-import-component",11),t.qCj("editEvent",function(o){t.usT(n);const a=t.GaO();return t.CGJ(a.editLayout(o))}),t.C$Y()()()}}function Rt(i,r){if(1&i){const n=t.KQA();t.I0R(0,"div")(1,"div",4)(2,"ul")(3,"li"),t.OEk(4),t.C$Y(),t.wR5(5,"li",5),t.I0R(6,"li")(7,"button",6),t.qCj("click",function(){t.usT(n);const o=t.GaO();return t.CGJ(o.save())}),t.OEk(8,"Save"),t.C$Y()()()(),t.I0R(9,"div",10),t.wR5(10,"app-editor-layout-component",12),t.C$Y()()}if(2&i){const n=t.GaO();t.yG2(4),t.oRS("Mah Editor: ",n.layout.name,""),t.yG2(6),t.E7m("layout",n.layout)}}let It=(()=>{class i{constructor(n){this.layoutService=n,this.mode="manager",this.closeEvent=new t._w7}save(){this.layoutComponent&&this.layoutComponent.toggleSave()}close(){"manager"!==this.mode?(this.layout=void 0,this.mode="manager"):this.closeEvent.emit()}editLayout(n){this.mode="edit",this.layout={id:"",name:n.name,by:n.by||"",category:n.category||"Custom",mapping:n.mapping.map(e=>[e[0],e[1],e[2]])}}exportLayouts(){!function rt(i){B("mah-layouts.mah",D(i),"text/json")}(this.layoutService.layouts.items)}newLayout(){this.editLayout({id:"",name:"New Layout",category:"Custom",by:"",mapping:[]})}onDropFiles(){}onDragFiles(){this.mode="import"}static#t=this.\u0275fac=function(e){return new(e||i)(t.GI1(C.O))};static#n=this.\u0275cmp=t.In1({type:i,selectors:[["app-editor-component"]],viewQuery:function(e,o){if(1&e&&t.CC$(Z,5),2&e){let a;t.wto(a=t.Gqi())&&(o.layoutComponent=a.first)}},outputs:{closeEvent:"closeEvent"},decls:22,vars:5,consts:[[1,"editor-content"],["title","Close",1,"close",3,"click"],[1,"icon-cancel-circled2","pull-right"],[1,"editor-manager"],[1,"editor-nav","buttons"],[1,"sep"],[3,"click"],[1,"editor-main",3,"appDropZone","appDropZoneOver"],[3,"inputLayouts","editEvent"],[1,"editor-nav"],[1,"editor-main"],[3,"editEvent"],[3,"layout"]],template:function(e,o){1&e&&(t.I0R(0,"div",0)(1,"a",1),t.qCj("click",function(){return o.close()}),t.wR5(2,"i",2),t.C$Y(),t.I0R(3,"div",3)(4,"div",4)(5,"ul")(6,"li"),t.OEk(7,"Mah Editor"),t.C$Y(),t.wR5(8,"li",5),t.I0R(9,"li")(10,"button",6),t.qCj("click",function(){return o.newLayout()}),t.OEk(11,"New"),t.C$Y()(),t.I0R(12,"li")(13,"button",6),t.qCj("click",function(){return o.mode="import"}),t.OEk(14,"Import"),t.C$Y()(),t.I0R(15,"li")(16,"button",6),t.qCj("click",function(){return o.exportLayouts()}),t.OEk(17,"Export"),t.C$Y()()()(),t.I0R(18,"div",7),t.qCj("appDropZone",function(){return o.onDropFiles()})("appDropZoneOver",function(){return o.onDragFiles()}),t.I0R(19,"app-manager-component",8),t.qCj("editEvent",function(s){return o.editLayout(s)}),t.C$Y()()(),t.yuY(20,Gt,7,0,"div")(21,Rt,11,2,"div"),t.C$Y()),2&e&&(t.yG2(3),t.eAK("visible","manager"===o.mode),t.yG2(16),t.E7m("inputLayouts",o.layoutService.layouts.items),t.yG2(),t.C0Y(20,"import"===o.mode?20:-1),t.yG2(),t.C0Y(21,"edit"===o.mode&&o.layout?21:-1))},dependencies:[Z,Pt,Et,F],styles:["[_nghost-%COMP%]{position:absolute;inset:0;background-color:var(--main-bg-color-dk);z-index:10001}[_nghost-%COMP%]   a[_ngcontent-%COMP%]{color:var(--main-content-link-color);cursor:pointer}[_nghost-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--main-content-link-hover-color)}[_nghost-%COMP%]   .close[_ngcontent-%COMP%]{position:absolute;right:10px;top:8px;cursor:pointer}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;background-image:none;border:1px solid var(--main-bg-color-dk);cursor:pointer;font-size:1em;color:var(--text-highlight-color);padding:2px 16px}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:var(--main-text-color-hover);border:1px solid var(--main-text-color-hover)}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{color:var(--text-disabled-color);cursor:default}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-manager[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-manager.visible[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-nav[_ngcontent-%COMP%]{padding:4px 8px 8px;border-bottom:1px solid var(--dialog-border-color)}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:0;margin:0 40px 0 0;list-style:none;display:flex}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:#fff;font-size:1.3em;padding-left:8px}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.sep[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{color:#ff0;cursor:default}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-main[_ngcontent-%COMP%]{flex:1;display:flex;overflow:hidden}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-main[_ngcontent-%COMP%]   .editor-select[_ngcontent-%COMP%]   .editor-wrapper[_ngcontent-%COMP%]{text-align:center;width:100%;max-width:800px}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-main[_ngcontent-%COMP%]   .editor-select[_ngcontent-%COMP%]   .editor-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:30px;padding:10px}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-main[_ngcontent-%COMP%]   .editor-select[_ngcontent-%COMP%]   .layout-selects[_ngcontent-%COMP%]{height:430px;max-width:800px;margin-top:20px;display:flex}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-main[_ngcontent-%COMP%]   .editor-select[_ngcontent-%COMP%]   .layout-list[_ngcontent-%COMP%]{border:1px solid var(--dialog-border-color);border-radius:6px;text-align:left;width:50%;overflow-y:hidden;color:var(--main-text-color);display:flex;flex-direction:column}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-main[_ngcontent-%COMP%]   .editor-select[_ngcontent-%COMP%]   .layout-list[_ngcontent-%COMP%]   .by[_ngcontent-%COMP%]{font-size:.7em}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-main[_ngcontent-%COMP%]   .editor-select[_ngcontent-%COMP%]   .layout-list[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-bottom:1px solid var(--dialog-border-color);padding:4px 8px;display:flex}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-main[_ngcontent-%COMP%]   .editor-select[_ngcontent-%COMP%]   .layout-list[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-main[_ngcontent-%COMP%]   .editor-select[_ngcontent-%COMP%]   .layout-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{flex:1;margin:0;padding:0;overflow-y:auto}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-main[_ngcontent-%COMP%]   .editor-select[_ngcontent-%COMP%]   .layout-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:var(--main-text-color);padding:4px;border-bottom:1px solid var(--dialog-border-color);cursor:pointer}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-main[_ngcontent-%COMP%]   .editor-select[_ngcontent-%COMP%]   .layout-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:#ffffff0d}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-main[_ngcontent-%COMP%]   .editor-select[_ngcontent-%COMP%]   .layout-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{float:right}[_nghost-%COMP%]   .editor-content[_ngcontent-%COMP%]   .editor-main[_ngcontent-%COMP%]   .editor-select[_ngcontent-%COMP%]   .layout-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .svg-board[_ngcontent-%COMP%]{height:30px;width:40px;margin-right:6px;display:inline-block;vertical-align:middle}"]})}return i})(),Tt=(()=>{class i{static getEditorComponentComponent(){return It}static#t=this.\u0275fac=function(e){return new(e||i)};static#n=this.\u0275mod=t.a4G({type:i});static#e=this.\u0275inj=t.s3X({imports:[G.MD,J.F]})}return i})()}}]);